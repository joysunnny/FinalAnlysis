<!DOCTYPE html>
<html>
<head>
  <title>Class → Method → Parameter Graph</title>
  <script type="text/javascript" src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
  <style>
    #network {
      width: 100%;
      height: 800px;
      border: 1px solid lightgray;
    }
  </style>
</head>
<body>
  <h2>Class → Method → Parameter Graph</h2>
  <div id="network"></div>

  <script>
    // === Paste your JSON here ===
    const data = [
      {
        "className": "com.example.controller.UserController",
        "fields": [
          {
            "name": "userService",
            "type": "com.example.service.UserService",
            "autowired": true
          }
        ],
        "methods": [
          {
            "name": "createUser",
            "returnType": "ResponseEntity<User>",
            "body": "return ResponseEntity.ok(userService.saveUser(user));",
            "parameters": [
              {
                "name": "user",
                "type": "User"
              }
            ]
          },
          {
            "name": "getUser",
            "returnType": "ResponseEntity<User>",
            "body": "return ResponseEntity.ok(userService.findById(id));",
            "parameters": [
              {
                "name": "id",
                "type": "Long"
              }
            ]
          }
        ],
        "level1Dependencies": [
          {
            "className": "com.example.service.UserService",
            "fields": [
              {
                "name": "userRepository",
                "type": "com.example.repository.UserRepository",
                "autowired": true
              }
            ],
            "methods": [
              {
                "name": "saveUser",
                "returnType": "User",
                "body": "return userRepository.save(user);",
                "parameters": [
                  {
                    "name": "user",
                    "type": "User"
                  }
                ]
              },
              {
                "name": "findById",
                "returnType": "User",
                "body": "return userRepository.findById(id).orElse(null);",
                "parameters": [
                  {
                    "name": "id",
                    "type": "Long"
                  }
                ]
              }
            ],
            "level1Dependencies": [
              {
                "className": "com.example.repository.UserRepository",
                "fields": [],
                "methods": [
                  {
                    "name": "save",
                    "returnType": "User",
                    "body": "/* JPA save logic */",
                    "parameters": [
                      {
                        "name": "user",
                        "type": "User"
                      }
                    ]
                  },
                  {
                    "name": "findById",
                    "returnType": "Optional<User>",
                    "body": "/* JPA findById logic */",
                    "parameters": [
                      {
                        "name": "id",
                        "type": "Long"
                      }
                    ]
                  }
                ],
                "level1Dependencies": []
              }
            ]
          }
        ]
      }
    ];

    // Graph data
    const nodes = [];
    const edges = [];
    let nodeId = 1;

    function addClassGraph(classObj, parentId = null) {
      const classNodeId = nodeId++;
      nodes.push({ id: classNodeId, label: classObj.className, shape: "box", color: "#ffd966" });

      if (parentId) {
        edges.push({ from: parentId, to: classNodeId, arrows: "to" });
      }

      // Methods
      classObj.methods.forEach(method => {
        const methodNodeId = nodeId++;
        nodes.push({ id: methodNodeId, label: method.name + " : " + method.returnType, shape: "ellipse", color: "#9fc5e8" });
        edges.push({ from: classNodeId, to: methodNodeId, arrows: "to" });

        // Parameters
        method.parameters.forEach(param => {
          const paramNodeId = nodeId++;
          nodes.push({ id: paramNodeId, label: param.name + " : " + param.type, shape: "circle", color: "#b6d7a8" });
          edges.push({ from: methodNodeId, to: paramNodeId, arrows: "to" });
        });
      });

      // Recursive dependencies
      classObj.level1Dependencies.forEach(dep => {
        addClassGraph(dep, classNodeId);
      });
    }

    data.forEach(classObj => addClassGraph(classObj));

    const container = document.getElementById("network");
    const networkData = { nodes: new vis.DataSet(nodes), edges: new vis.DataSet(edges) };
    const options = {
      layout: { hierarchical: { enabled: true, direction: "UD", sortMethod: "directed" } },
      nodes: { font: { size: 16 }, borderWidth: 2 },
      edges: { arrows: "to", smooth: true }
    };

    new vis.Network(container, networkData, options);
  </script>
</body>
</html>
